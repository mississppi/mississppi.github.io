---
title: "テストを読みやすくする"
slug: "readable-tests"
tags: ["テスト", "保守性", "第14章"]
source: "リーダブルコード 第14章"
order: 14
---

テストはコードの品質を守るための重要な手段です。  
この章では、**テストそのものの可読性と保守性を高める工夫**が紹介されています。

---

## テストを読みやすく保守しやすくする

テストコードも実際のコードと同じく、**読みやすく、意図が明確であることが大切**です。  
テストの読みやすさが、バグの発見効率やコード改善意欲に大きく影響します。

---

## 最小のテストを作る

1つのテストで**複数のケースを同時に検証しないこと**。  
- **1テスト = 1目的** を意識しよう  
- テストが失敗したときに「何が悪いか」が一目でわかるように

---

## 独自のミニ言語を実装する

たとえば `assertEquals(expected, actual)` を独自に `expect(actual).toEqual(expected)` のように  
**読みやすくラップすることで、テスト文を自然言語のように読めるようにする**工夫。

---

## エラーメッセージを読みやすく

テストが失敗したとき、**エラー内容が原因を特定できるように**しておく。

```js
assertEquals(user.name, "Alice", "ユーザー名が正しくセットされていること");
```

---

## テストに適切な入力値を設計する

- 境界値、エラー値、異常系、ゼロなどをカバー
- 「実際にありがちな」入力に近づけることで、**信頼性のあるテスト**になる

---

## テストの機能に名前をつける

### テスト対象を明確に：
- クラス名
- 関数名
- 状況名（バグ番号・ユースケース）

```js
test("User#login: 正しいパスワードでログイン成功する", () => {
  ...
});
```

---

## 設計とテスト容易性の関係（まとめ表）

| 特性 | テスト容易性の問題 | 設計上の問題 |
|------|--------------------|--------------------------|
| **1. グローバル変数を使っている** | 各テストで初期化が必要 | 副作用の範囲が不明。全体の理解が必要 |
| **2. 外部コンポーネントに依存** | テスト前のセットアップが大変。書かれなくなる | 依存先の不具合に弱く、リファクタが困難 |
| **3. 非決定的な動作** | テスト結果が不安定で信頼できない | バグの再現が困難。追跡・修正が難しい |

---


---

## テストしやすいコードの特徴と設計の利点

| 特性 | テスト容易性の利点 | 設計上の利点 |
|------|--------------------|--------------------------|
| **1. クラスが小さく、内部状態を持たない** | テストしやすい | 状態が少なく、理解しやすい |
| **2. クラスが1つのことをしている** | テストケースが少なくて済む | 小さいコンポーネントとしてモジュール化され、疎結合 |
| **3. クラスが高度に疎結合している** | 独立してテストできる | 並列開発や修正・削除がしやすい |
| **4. 関数が単純でインターフェースが明確** | 明確な動作をテストでき、テストが楽 | わかりやすく、再利用しやすい |


## まとめ

- テストコードも「読みやすさ」が重要
- 最小単位で書き、意図を明示しよう
- テストが失敗したときの原因がすぐわかるように工夫する
- テスト困難な構造（副作用・依存・非決定性）は設計の見直しポイント
